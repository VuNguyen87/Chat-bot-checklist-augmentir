let ss = SpreadsheetApp.getActiveSpreadsheet();
let setup = ss.getSheetByName("Push noti");
let dayOff = ss.getSheetByName("day off");
function chatBot_ThangChuA() {
  let lastRow = setup.getRange('A12').getDataRegion().getLastRow();
  console.log(lastRow)
  try {
    let value = setup.getRange('B12').getValue();
    if (value !== "") {
      for (i = 12; i <= lastRow; i++) {
        let thangName = setup.getRange('A' + i).getValue();
        const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
        //const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nThang ch·ªØ A: - ' + thangName + ', ch∆∞a ƒë∆∞·ª£c Checklist. \nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
      return;
    }
  } catch (e) {
    MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code chatBot_ThangChuA', 'Chi ti·∫øt l·ªói :' + e);
  }
  return;
}
/*/********************************************************************* */

function chatBot_SpillKit() {
  let lastRow = setup.getRange('G12').getDataRegion().getLastRow();
  console.log(lastRow)
  try {
    let value = setup.getRange('H12').getValue();
    if (value !== "") {
      for (i = 12; i <= lastRow; i++) {
        let khuVuc = setup.getRange('G' + i).getValue();
        const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
        //const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nChecklist Spill Kit khu v·ª±c:  - ' + khuVuc + ', ch∆∞a ƒë∆∞·ª£c Checklist. \nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
      return;
    }
  } catch (e) {
    MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code chatBot_SpillKit', 'Chi ti·∫øt l·ªói :' + e);
  }
  return;
}
//****************************************************************** */

// function chatbot_OE() {
//   let ss = SpreadsheetApp.getActiveSpreadsheet();
//   let setup = ss.getSheetByName("noti_OE");
//   let data = setup.getDataRange().getValues();
//   let currentDate = new Date();
//   let Avals = setup.getRange("B1:B").getValues();
//   let lastRow = Avals.filter(String).length;
//   let weekNumber = getWeekNumber(currentDate);
//   let filteredData = data.filter(function (row) {
//     let date = row[0];
//     let source = row[2];
//     let user = row[1];
//     let week = row[14]
//     // Ki·ªÉm tra n·∫øu ng√†y l√† ng√†y hi·ªán t·∫°i v√† source l√† "Self Assessment"
//     return (weekNumber === week) && (source === "Self Assessment");
//   });
//   let dem = filteredData.map(function (row) {
//     return row[1]
//   }).length;
//     console.log(dem)
//   let lost = 4 - dem;
//   if( lost !== 0){
//   ///  In k·∫øt qu·∫£
//   // L·∫•y d·ªØ li·ªáu t·ª´ c·ªôt "User" v√† k·∫øt h·ª£p v·ªõi ƒëi·ªÅu ki·ªán xu·ªëng h√†ng
//   let result = filteredData.map(function (row) {
//     return "‚úÖ " + row[1]; // L·∫•y gi√° tr·ªã c·ªôt "User"
//   }).join("\n"); // K·∫øt h·ª£p th√†nh chu·ªói v·ªõi ƒëi·ªÅu ki·ªán xu·ªëng h√†ng
//   const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
//   //const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
//   // N·ªôi dung c·∫ßn chat 
//   const Content = 'Xin Ch√†o, \nL·ªãch ch·∫•m OE tu·∫ßn n√†y c√≥ ' + lost + ' khu v·ª±c CH∆ØA ƒê∆Ø·ª¢C TH·ª∞C HI·ªÜN.\nD∆∞·ªõi ƒë√¢y l√† danh s√°ch ƒë√£ ho√†n th√†nh:\n' + result+'.\nüôè Vui l√≤ng c·∫≠p nh·∫≠t & b·ªï sung!';
//  // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
//   UrlFetchApp.fetch(urlBot, {
//     method: 'POST',
//     headers: {
//       'Content-Type': 'application/json',
//     },
//     payload: JSON.stringify({
//       text: Content
//     })
//   })
//   }
// }
//****************************************************************** */
function chatbot_OPL() {
  let ss = SpreadsheetApp.getActiveSpreadsheet();
  let setup = ss.getSheetByName("master_OPL");
  let data = setup.getDataRange().getValues();
  let currentDate = new Date();
  let currentMonth = currentDate.getMonth() + 1; // L·∫•y th√°ng hi·ªán t·∫°i (1-12)
  let filteredData = data.filter(function (row) {
    let khuVuc = row[16];
    let date = new Date(row[0]);
    let month = date.getMonth() + 1; // L·∫•y th√°ng t·ª´ c·ªôt ng√†y (1-12)
    console.log(currentMonth)
    return khuVuc === "WH" && month === currentMonth;
  });
  let result = filteredData.length > 0 ? filteredData.length.toString() : "0"; // G√°n s·ªë d√≤ng cho bi·∫øn k·∫øt qu·∫£, n·∫øu kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu, g√°n gi√° tr·ªã "0"
  const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
  //const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
  // N·ªôi dung c·∫ßn chat 
  const Content = 'Xin Ch√†o,\nüìÜ Th√°ng ' + currentMonth + ' ch∆∞a c√≥ b√†i h·ªçc 1 ƒëi·ªÉm ƒë∆∞·ª£c chia s·∫ª.\nüôè Vui l√≤ng c·∫≠p nh·∫≠t & b·ªï sung!'
  // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
  UrlFetchApp.fetch(urlBot, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    payload: JSON.stringify({
      text: Content
    })
  })
}

/*/********************************************************************* */

function chatBot_CauTruc() {
  try {
    let value1 = setup.getRange('E3').getValue();
    let value2 = setup.getRange('E4').getValue();
    let khuVuc1 = setup.getRange('D3').getValue();
    let khuVuc2 = setup.getRange('D4').getValue();
    if (value1 == 0) {
      // const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
      const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
      // N·ªôi dung c·∫ßn chat 
      const Content1 = 'Xin Ch√†o, \nChecklist C·∫©u tr·ª•c:    ' + khuVuc1 + ' ‚û£ Ch∆∞a ƒë∆∞·ª£c Checklist. \nüôè Vui l√≤ng ki·ªÉm tra l·∫°i! \n ‚ñÑÔ∏ªÃ∑Ãø‚îªÃø‚ïê‚îÅ‰∏Ä  ÏõÉ  $$$$$$$';
      UrlFetchApp.fetch(urlBot, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        payload: JSON.stringify({
          text: Content1
        })
      })
    }
    if (value2 == 0) {
      // const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
      const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
      // N·ªôi dung c·∫ßn chat 
      const Content2 = 'Xin Ch√†o, \nChecklist C·∫©u tr·ª•c:    ' + khuVuc2 + ' ‚û£ Ch∆∞a ƒë∆∞·ª£c Checklist. \nüôè Vui l√≤ng ki·ªÉm tra l·∫°i! \n \n ‚ñÑÔ∏ªÃ∑Ãø‚îªÃø‚ïê‚îÅ‰∏Ä  ÏõÉ  $$$$$$$';
      UrlFetchApp.fetch(urlBot, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        payload: JSON.stringify({
          text: Content2
        })
      })
      return;
    }
  } catch (e) {
    MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code chatBot_CauTruc', 'Chi ti·∫øt l·ªói :' + e);
  }
  return;
}

/*/********************************************************************* */

function chatBot_Oe() {
  let lastRow = setup.getRange('J12').getDataRegion().getLastRow();
  console.log(lastRow)
  try {
    let value = setup.getRange('K12').getValue();
    if (value !== "") {
      for (i = 12; i <= lastRow; i++) {
        let khuVuc = setup.getRange('J' + i).getValue();
        const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
        //const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nCh·∫•m ƒëi·ªÉm OE khu v·ª±c:   <' + khuVuc + '>, ch∆∞a ƒë∆∞·ª£c th·ª±c hi·ªán. \nüôè Vui l√≤ng ki·ªÉm tra v√† c·∫≠p nh·∫≠t b·ªï sung!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
      return;
    }
  } catch (e) {
    MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code chatBot_Oe', 'Chi ti·∫øt l·ªói :' + e);
  }
  return;
}

//***************************************************************************************************************************************/

function chatBot_ChecklistSanKho() {
  let today = new Date();
  let day = today.getDay();
  if (day !== 0) {
    try {
      const sh = SpreadsheetApp.getActiveSpreadsheet();
      const sheet1 = sh.getSheetByName("Push noti");
      let value = sheet1.getRange('E2').getValue();
      if (value == 0) {
        //  const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
        const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nPhi·∫øu ki·ªÉm tra s√¢n kho ch∆∞a ƒë∆∞·ª£c th·ª±c hi·ªán. \nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
      return;
    } catch (e) {
      MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code chatBot_ChecklistSanKho', 'Chi ti·∫øt l·ªói :' + e);
    }
    return;
  }
}
//***************************************************************************************************************************************/
// function ChatBot_ChecklistForklift_Nodata() {
//   let today = new Date();
//   let day = today.getDay();
//   if (day !== 0) {
//     try {

//       const sh = SpreadsheetApp.getActiveSpreadsheet();
//       const sheet1 = sh.getSheetByName("Push noti");
//       let value = sheet1.getRange('J23').getValue();
//       let lastRow = sheet1.getRange('J23').getDataRegion().getLastRow();
//       console.log(lastRow)
//       if (value !== "") {
//         for (i = 23; i <= lastRow; i++) {
//           let xe = sheet1.getRange('G' + i).getValue();
//           let ca = sheet1.getRange('I' + i).getValue();

//           const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
//           // const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
//           // N·ªôi dung c·∫ßn chat 
//           const Content = 'Xin Ch√†o, \nXe s·ªë: ' + xe + ', nh√≥m: ' + ca + ', ch∆∞a ƒë∆∞·ª£c Checklist xe n√¢ng ƒë·∫ßu ca. \nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
//           // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
//           UrlFetchApp.fetch(urlBot, {
//             method: 'POST',
//             headers: {
//               'Content-Type': 'application/json',
//             },
//             payload: JSON.stringify({
//               text: Content
//             })
//           })
//         }
//         return;
//       }
//     } catch (e) {
//       MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code ChatBot_ChecklistXeNang_Nodata', 'Chi ti·∫øt l·ªói :' + e);
//     }
//     return;
//   }
// }

function chatBot_ChecklistForklift_Nodata() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Push noti");
  var dataRange = sheet.getRange('Q2:R17'); // Ch·ªâ l·∫•y 2 c·ªôt Q v√† R
  var values = dataRange.getValues();
  var numRows = values.length;
  var selectedRows = [];
  let today = new Date();
  let day = today.getDay();
  if (day !== 0) {
    try {
      for (var i = 0; i < numRows; i++) {
        if (values[i][values[i].length - 1] === "No data") {
          selectedRows.push("- Xe " + values[i].join(' ')); // Th√™m ch·ªØ "xe" ·ªü ƒë·∫ßu v√† gh√©p c√°c gi√° tr·ªã th√†nh m·ªôt chu·ªói
        }
      }
      console.log(selectedRows.length);
      var jsonResult = selectedRows.join("\n");
      if (selectedRows.length > 0) {
      const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
       //  const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nD∆∞·ªõi ƒë√¢y l√† danh s√°ch c√°c xe ch∆∞a ƒë∆∞·ª£c Checklist.\n' + jsonResult + ' \nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
      return;
    } catch (e) {
      MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code ChatBot_ChecklistXeNang_Nodata', 'Chi ti·∫øt l·ªói :' + e);
    }
    return;
  }
}

//*-********************************************************************///
function chatBot_ChecklistRack() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Push noti"); // Thay "T√™n_B·∫£ng" b·∫±ng t√™n b·∫£ng d·ªØ li·ªáu c·ªßa b·∫°n
  var dataRange = sheet.getRange("U3:V5");
  var values = dataRange.getValues();
  var numRows = values.length;
  var group = sheet.getRange("V2").getValue();
  var selectedRows = [];
 let today = new Date();
  let day = today.getDay();
  if (day !== 0) {
    try {
  
  for (var i = 0; i < numRows; i++) {
    var lastColumnValue = values[i][values[i].length - 1];
    if (lastColumnValue === 0) {
          selectedRows.push('- '+values[i][0]);
    }
  }
var jsonResult = selectedRows.join("\n")
      if (selectedRows.length > 0) {
       // const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
         const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAJNVbkgA/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=mH5dDxOrXHw-QuzU-hcnri29KHo9zAFrN2LljLp5mgg';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nD∆∞·ªõi ƒë√¢y l√† danh s√°ch c√°c K·ªÜ ch∆∞a ƒë∆∞·ª£c Checklist.\n' + jsonResult + ' \nNh√≥m ph·ª• tr√°ch: '+group+'\nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
      return;
  Logger.log(jsonResult);

   } catch (e) {
      MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code ChatBot_ChecklistRack', 'Chi ti·∫øt l·ªói :' + e);
    }
    return;
  }
}
//*-********************************************************************///
function chatBot_ApproveForklift_Rack() {
var valueForklift = setup.getRange("S18").getValue();  // l·∫•y gi√° tr·ªã phi·∫øu xe ch∆∞a duy·ªát
var valueRack = setup.getRange("V18").getValue();  // l·∫•y gi√° tr·ªã phi·∫øu k·ªá ch∆∞a duy·ªát
 let today = new Date();
  let day = today.getDay();
  if (day !== 0) {
    try {
      if (valueForklift > 0) {
       // const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
        const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAY0-w-lo/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=cTVxb4he2vJXWgaUQN4P_ttYFXTLrAiXjDCBXQFaCHY';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nC√≥ '+valueForklift+' Phi·∫øu checklist xe n√¢ng h·∫±ng ng√†y ch∆∞a ƒë∆∞·ª£c duy·ªát.\nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
        if (valueRack > 0) {
        //const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAIGBUOjE/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=AJP7A3VJqAnhQEmJFFlgBpVLXxsimOLV_au9BcS1Z_U';
         const urlBot = 'https://chat.googleapis.com/v1/spaces/AAAAY0-w-lo/messages?key=AIzaSyDdI0hCZtE6vySjMm-WEfRq3CPzqKqqsHI&token=cTVxb4he2vJXWgaUQN4P_ttYFXTLrAiXjDCBXQFaCHY';
        // N·ªôi dung c·∫ßn chat 
        const Content = 'Xin Ch√†o, \nC√≥ '+valueRack+' Phi·∫øu checklist K·ªá h·∫±ng ng√†y ch∆∞a ƒë∆∞·ª£c duy·ªát.\nüôè Vui l√≤ng ki·ªÉm tra l·∫°i!';
        // Code c·ªë ƒë·ªãnh kh√¥ng thay ƒë·ªïi c√°c t·ª´ kh√≥a b√™n trong, ch·ªâ thay bi·∫øn ·ªü d√≤ng text:
        UrlFetchApp.fetch(urlBot, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          payload: JSON.stringify({
            text: Content
          })
        })
      }
      return;
  console.log(valueForklift,valueRack)

   } catch (e) {
      MailApp.sendEmail('vu_nguyen@colpal.com', 'Th√¥ng b√°o l·ªói code chatBot_ApproveForklift_Rack', 'Chi ti·∫øt l·ªói :' + e);
    }
    return;
  }
}

